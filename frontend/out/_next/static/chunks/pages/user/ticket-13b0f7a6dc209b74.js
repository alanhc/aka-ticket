(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[351],{4369:function(t,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/ticket",function(){return e(7334)}])},4547:function(t,n,e){"use strict";e.d(n,{Z:function(){return p}});var r=e(5893),c=e(4051),o=e.n(c),u=e(262),s=e(7294),a=e(6489);function i(t,n,e,r,c,o,u){try{var s=t[o](u),a=s.value}catch(i){return void e(i)}s.done?n(a):Promise.resolve(a).then(r,c)}function f(t){return function(){var n=this,e=arguments;return new Promise((function(r,c){var o=t.apply(n,e);function u(t){i(o,r,c,u,s,"next",t)}function s(t){i(o,r,c,u,s,"throw",t)}u(void 0)}))}}function l(t){var n=(0,s.useState)(null),e=n[0],c=n[1],i=function(){var t=f(o().mark((function t(){var n,e,r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,a.GS)();case 2:n=t.sent,e=n.success,r=n.wallet,console.log("connecting..",r,e),c(r);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),l=function(){var t=f(o().mark((function t(){var n,e,r;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,a.iy)();case 2:n=t.sent,e=n.success,r=n.wallet,console.log("disconnect..",r,e),c(r);case 7:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return(0,r.jsxs)("div",{children:[(0,r.jsx)(u.Link,{route:"/verifier",children:(0,r.jsx)("a",{className:"btn",children:"Verifier"})}),(0,r.jsx)(u.Link,{route:"/user",children:(0,r.jsx)("a",{className:"btn",children:"User"})}),(0,r.jsx)(u.Link,{route:"#",children:(0,r.jsx)("a",{className:"btn",onClick:e?l:i,children:e?e.slice(0,4)+"..."+e.slice(e.length-4,e.length):"Connect wallet"})})]})}var p=function(t){var n=t.children;return(0,r.jsxs)("div",{className:" flex flex-col items-center justify-between",children:[(0,r.jsx)(l,{}),n]})}},7334:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return x}});var r=e(4051),c=e.n(r),o=e(5893),u=e(9188),s=e(7294),a=e(4547),i=e(1653);function f(t){return console.log(t),(0,o.jsx)("div",{style:{height:"auto",margin:"0 auto",maxWidth:128,width:"100%"},children:(0,o.jsx)(i.Z,{value:JSON.stringify(t)})})}var l=e(5235),p=e(3866),d=e(6489);function v(t,n,e,r,c,o,u){try{var s=t[o](u),a=s.value}catch(i){return void e(i)}s.done?n(a):Promise.resolve(a).then(r,c)}function h(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function Q(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{},r=Object.keys(e);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(e).filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})))),r.forEach((function(n){h(t,n,e[n])}))}return t}function x(t){var n=(0,s.useContext)(l.R),e=n.ticket;n.setTicket;console.log(e);var r=(0,s.useState)({contract:"KT1QQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ",tokenId:-1,otp:"otp_test",address:"tz1XqjqZYQQQQQQQQQQQQQQQQQQQQQQQQQQQQQQ"}),i=r[0],h=r[1],x=(0,s.useState)("1"),g=x[0],w=x[1],b=function(){var t,n=(t=c().mark((function t(){var n,r,o,s,a,i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.gU.client.requestSignPayload({signingType:u.Jr.MICHELINE,payload:"05010000000833313332333333343335333633373338"});case 2:return n=t.sent,t.next=5,(0,d.GS)();case 5:return t.next=7,t.sent.wallet;case 7:return r=t.sent,o=e.contract,s=e.tokenId,a=g,console.log("==",r,o,s,a,n.signature),t.next=14,(0,p.H7)(r,o,s,a,n.signature);case 14:i=t.sent,h({otp:i.data,contract:o,tokenId:s,address:r});case 16:case"end":return t.stop()}}),t)})),function(){var n=this,e=arguments;return new Promise((function(r,c){var o=t.apply(n,e);function u(t){v(o,r,c,u,s,"next",t)}function s(t){v(o,r,c,u,s,"throw",t)}u(void 0)}))});return function(){return n.apply(this,arguments)}}();return(0,o.jsxs)(a.Z,{children:[JSON.stringify(i),(0,o.jsxs)("h1",{className:"text-3xl font-bold underline",children:[" ",e.name," "]}),(0,o.jsx)("img",{src:e.thumbnailUri,width:500,height:500}),(0,o.jsx)("input",{onChange:function(t){return w(t.target.value)},className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none",defaultValue:"1"}),(0,o.jsx)("button",{className:"btn btn-blue",onClick:function(){return b()},children:"activate"}),32!==i.otp.length&&"otp_test"!==i.otp&&(0,o.jsx)("p",{children:i.otp}),32===i.otp.length&&"otp_test"!==i.otp&&(0,o.jsx)(f,Q({},i))]})}},262:function(t,n,e){"use strict";var r=e(7018)();t.exports=r},3866:function(t,n,e){"use strict";e.d(n,{DD:function(){return p},H7:function(){return l},bG:function(){return f}});var r=e(4051),c=e.n(r),o=e(9669),u=e.n(o);function s(t,n,e,r,c,o,u){try{var s=t[o](u),a=s.value}catch(i){return void e(i)}s.done?n(a):Promise.resolve(a).then(r,c)}function a(t){return function(){var n=this,e=arguments;return new Promise((function(r,c){var o=t.apply(n,e);function u(t){s(o,r,c,u,a,"next",t)}function a(t){s(o,r,c,u,a,"throw",t)}u(void 0)}))}}console.log("backend url: https://140.112.30.39:5000");var i=u().create({baseURL:"https://140.112.30.39:5000"}),f=function(){var t=a(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,i.get("/ticket/".concat(n)).then((function(t){return t.data}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),l=function(){var t=a(c().mark((function t(n,e,r,o,s){var a,i;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=JSON.stringify({signature:"".concat(s),message:"12345678"}),i={method:"post",url:"".concat("https://140.112.30.39:5000","/activate/").concat(n,"/").concat(e,"/").concat(r,"/").concat(o),headers:{"Content-Type":"application/json"},data:a},t.next=4,u()(i).then((function(t){return console.log("---success",t),t})).catch((function(t){return console.log("---err",t.response.status,t.response,{address:n,contract:e,ticketid:r,cnt:o,signature:s}),t.response}));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(n,e,r,c,o){return t.apply(this,arguments)}}(),p=function(){var t=a(c().mark((function t(n,e,r,o){var s,a;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s=JSON.stringify({otp:n,address:e}),a={method:"post",url:"".concat("https://140.112.30.39:5000","/verify/").concat(r,"/").concat(o),headers:{"Content-Type":"application/json"},data:s},t.next=4,u()(a).then((function(t){return console.log("---success",t),t})).catch((function(t){return console.log("---err",t.response.status,t.response),t.response}));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(n,e,r,c){return t.apply(this,arguments)}}()},6489:function(t,n,e){"use strict";e.d(n,{GS:function(){return l},gU:function(){return f},iy:function(){return p}});var r=e(4051),c=e.n(r),o=e(2813);function u(t,n,e,r,c,o,u){try{var s=t[o](u),a=s.value}catch(i){return void e(i)}s.done?n(a):Promise.resolve(a).then(r,c)}function s(t){return function(){var n=this,e=arguments;return new Promise((function(r,c){var o=t.apply(n,e);function s(t){u(o,r,c,s,a,"next",t)}function a(t){u(o,r,c,s,a,"throw",t)}s(void 0)}))}}var a=e(9188).td.MAINNET,i={name:"NFT",iconUrl:"https://tezostaquito.io/img/favicon.png",preferredNetwork:a},f=new o.kx(i),l=(function(){var t=s(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.client.getActiveAccount();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))}(),function(){var t=s(c().mark((function t(){var n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.client.getActiveAccount();case 2:if(n=t.sent){t.next=9;break}return t.next=6,f.requestPermissions({network:{type:a}});case 6:return t.next=8,f.client.getActiveAccount();case 8:n=t.sent;case 9:return t.abrupt("return",{success:!0,wallet:n.address});case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()),p=function(){var t=s(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.clearActiveAccount();case 2:return t.abrupt("return",{success:!0,wallet:null});case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();!function(){var t=s(c().mark((function t(n){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.client.getActiveAccount();case 3:if(t.sent){t.next=7;break}return t.next=7,n.client.requestPermissions({type:{network:a}});case 7:return t.abrupt("return",{success:!0});case 10:return t.prev=10,t.t0=t.catch(0),t.abrupt("return",{success:!1,error:t.t0});case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))}()},5883:function(){},6601:function(){},9214:function(){},5992:function(){},2361:function(){},4616:function(){}},function(t){t.O(0,[78,714,572,861,925,669,653,774,888,179],(function(){return n=4369,t(t.s=n);var n}));var n=t.O();_N_E=n}]);